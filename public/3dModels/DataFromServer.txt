Dima onboarding


dima-khorkin

User name,Password,Access key ID,Secret access key,Console login link
dima-khorkin,,AKIAV3VQIQHGVQLRWTG2,zRCzt9+Dg3l4k/8I2+IltdMeVAsdhrhcIrWoHbJi,https://403022840269.signin.aws.amazon.com/console

User Name,Password
dima-khorkin-at-403022840269,4bDzAsjC84qa1HD66c1oy4ktsDwutBFHd6q4rTMUvow=


UNAME=dima-khorkin-at-403022840269
PASSWORD=4bDzAsjC84qa1HD66c1oy4ktsDwutBFHd6q4rTMUvow=
REPO=ommie-backend	
git clone https://$UNAME:"$PASSWORD"@git-codecommit.us-east-2.amazonaws.com/v1/repos/$REPO


0. AWS CONSOLE
	LOGIN - dima-khorkin
	PASSWORD - 13D68gJa24dGf!!!

1. HOW TO CONFIGURE AWS

aws configure
aws sts get-caller-identity	

2. HOW TO RUN BACKEND LOCALLY

(change local db password to yours....)

export GEO_API_KEY='AIzaSyCVXU6LIC6rilnt1sVrv5EPgljoDru6bv8' && \


export RDS_DB_NAME=ommie && \
export RDS_HOSTNAME=127.0.0.1 && \
export RDS_USERNAME=root && \
export RDS_PASSWORD='13D68gJa24dGf...' && \
export RDS_PORT=3306 && \
export S3_BUCKET=ommie-images-dev && \
export USERPOOL=us-east-2_WSkB2cFQD && \
export AWS_REGION=us-east-2 && \
export AWS_ACCESS_KEY_ID='AKIAV3VQIQHGVQLRWTG2' && \
export AWS_SECRET_ACCESS_KEY='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' && \
export NODE_ENV='development' && \
nodemon app.js

3. HOW TO CREATE A TEST USER

USERPOOL=us-east-2_WSkB2cFQD && \
CLIENT=7ag8u49je067r47m989mlrnp3d && \
AWS_REGION=us-east-2 && \
USERNAME=TestUser4@email.com && \
PASSWORD='1qaz!QAZ' && \
aws cognito-idp admin-create-user --user-pool-id $USERPOOL --username $USERNAME --region $AWS_REGION && \
aws cognito-idp admin-set-user-password --user-pool-id $USERPOOL --username $USERNAME --password $PASSWORD --region $AWS_REGION --permanent

3. HOW TO GET A TEST USER

USERPOOL=us-east-2_WSkB2cFQD && \
AWS_REGION=us-east-2 && \
USERNAME=TestUser5@email.com && \
aws cognito-idp admin-get-user --user-pool-id $USERPOOL --username $USERNAME 


4. HOW TO GET A TOKEN FOR THIS USER

USERPOOL=us-east-2_WSkB2cFQD && \
CLIENT=7ag8u49je067r47m989mlrnp3d && \
AWS_REGION=us-east-2 && \
USERNAME=TestUser4@email.com && \
PASSWORD='1qaz!QAZ' && \
PAYLOAD='{"AuthParameters" : {"USERNAME" : "'$USERNAME'","PASSWORD" : "'$PASSWORD'"},"AuthFlow" : "USER_PASSWORD_AUTH","ClientId" : "'$CLIENT'"}' && \
TOKEN=$(curl -X POST -d "$PAYLOAD" \
-H 'X-Amz-Target: AWSCognitoIdentityProviderService.InitiateAuth' \
-H 'Content-Type: application/x-amz-json-1.1' \
https://cognito-idp.us-east-2.amazonaws.com/ | jq -r '.AuthenticationResult.IdToken') && \
echo $TOKEN

5. HOW TO MAKE A TEST CALL

export ENDPOINT=http://localhost:3000/api

go to... /ommie-backend/infrastructure/test-backend.sh


6. HOW TO DELETE A TEST USER

USERPOOL=us-east-2_WSkB2cFQD && \
AWS_REGION=us-east-2 && \
USERNAME=TestUser3@email.com && \
PASSWORD='1qaz!QAZ' && \
aws cognito-idp admin-delete-user --user-pool-id $USERPOOL --username $USERNAME --region $AWS_REGION
